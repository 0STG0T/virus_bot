# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Virus Bot - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã VirusGift.pro —á–µ—Ä–µ–∑ Telegram –±–æ—Ç. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 500+ –∞–∫–∫–∞—É–Ω—Ç–æ–≤, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—Ä–∏ —Å–ø–∏–Ω—ã, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—ã, —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã.

## Running the Bot

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ –æ—Ç @BotFather)
python main.py
```

–ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. –°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–∞–ø–∫–µ `sessions/` (—Ñ–æ—Ä–º–∞—Ç: `–∏–º—è_–∞–∫–∫–∞—É–Ω—Ç–∞.session`, Telethon format).

## Architecture Overview

### Core Components

**main.py** - Entry point. –°–æ–∑–¥–∞–µ—Ç VirusBotManager –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Telegram –±–æ—Ç–∞. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–µ—Å—Å–∏–π, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω –±–æ—Ç–∞.

**telegram_bot.py (VirusBotManager)** - Telegram bot UI. –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –±–æ—Ç–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã (/start), callback –∫–Ω–æ–ø–∫–∏ (—Ñ—Ä–∏ —Å–ø–∏–Ω—ã, –±–∞–ª–∞–Ω—Å, –≤–∞–ª–∏–¥–∞—Ü–∏—è). –ó–∞–ø—É—Å–∫–∞–µ—Ç –µ–∂–µ—á–∞—Å–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å –±–∞–ª–∞–Ω—Å–æ–º >= 200 –∑–≤–µ–∑–¥. –°–æ–¥–µ—Ä–∂–∏—Ç progress callbacks –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–ø–µ—Ä–∞—Ü–∏–π.

**session_manager.py (SessionManager)** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Telegram —Å–µ—Å—Å–∏—è–º–∏. –ó–∞–≥—Ä—É–∂–∞–µ—Ç .session —Ñ–∞–π–ª—ã –∏–∑ `sessions/`, —Å–æ–∑–¥–∞–µ—Ç TelegramClient –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞—Ñ–æ—Ä—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è SQLite database lock conflicts. –ö—ç—à–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é —Å–µ—Å—Å–∏–π (TTL: 5 –º–∏–Ω—É—Ç).

**spin_worker.py (SpinWorker)** - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—Ä–∏ —Å–ø–∏–Ω—ã –∏ –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –∫–∞–Ω–∞–ª—ã, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∏–∫–∞–µ—Ç –ø–æ —Ç–µ—Å—Ç–æ–≤—ã–º —Å—Å—ã–ª–∫–∞–º (WebApp –∏ channels), –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∑–≤–µ–∑–¥—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞–µ—Ç –¥–µ—à–µ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏ (‚â§200 –∑–≤–µ–∑–¥). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç batch –æ–±—Ä–∞–±–æ—Ç–∫—É —Å progress callbacks.

**virus_api.py (VirusAPI)** - GraphQL API –∫–ª–∏–µ–Ω—Ç –¥–ª—è virusgift.pro. –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ authTelegramInitData, –ø–æ–ª—É—á–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã, –¥–µ–ª–∞–µ—Ç —Å–ø–∏–Ω—ã (—Ñ—Ä–∏ –∏ –ø–ª–∞—Ç–Ω—ã–µ), —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º (getRouletteInventory), –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∑–≤–µ–∑–¥—ã (claimRoulettePrize), –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç –ø–æ–¥–∞—Ä–∫–∏ (exchangeRoulettePrizeToStarsBalance). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å, –±–∞–ª–∞–Ω—Å—ã, –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**webapp_auth.py (WebAppAuth)** - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ WebApp. –ü–æ–ª—É—á–∞–µ—Ç init_data –æ—Ç Telegram WebApp (@virus_play_bot), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫–∏ –ø–æ —Ç–µ—Å—Ç–æ–≤—ã–º —Å—Å—ã–ª–∫–∞–º —á–µ—Ä–µ–∑ requestWebView.

**config.py** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è. Telegram API credentials, GraphQL endpoints, —Ç–∞–π–º–∞—É—Ç—ã, –ª–∏–º–∏—Ç—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (MAX_CONCURRENT_SESSIONS: 100), –ø–æ—Ä–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (AUTO_SPIN_THRESHOLD: 200 –∑–≤–µ–∑–¥), –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

**logging_config.py** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è GraphQL –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤, –æ–±—â–∏—Ö —Å–æ–±—ã—Ç–∏–π, debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ú–∞—Å–∫–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –≤ –ª–æ–≥–∞—Ö. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (50MB –¥–ª—è –æ–±—â–∏—Ö, 100MB –¥–ª—è GraphQL).

### Key Workflows

**–§—Ä–∏ —Å–ø–∏–Ω (perform_single_spin)**:
1. –°–æ–∑–¥–∞–µ—Ç TelegramClient —á–µ—Ä–µ–∑ SessionManager
2. –ü–æ–ª—É—á–∞–µ—Ç WebApp auth data —á–µ—Ä–µ–∑ WebAppAuth
3. –°–æ–∑–¥–∞–µ—Ç VirusAPI –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è (–ø–æ–ª—É—á–∞–µ—Ç JWT)
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –æ—á–∏—â–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª—ã (cleanup_channel_subscriptions):
   - –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –∫–∞–Ω–∞–ª—ã
   - –ï—Å–ª–∏ > 100 –∫–∞–Ω–∞–ª–æ–≤ ‚Üí –æ—Ç–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –æ—Ç –í–°–ï–• –∫–∞–Ω–∞–ª–æ–≤ –ø–∞—á–∫–∞–º–∏ –ø–æ 50 (–∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã)
   - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–ø–∏–Ω–∞ (check_spin_availability)
6. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ø–∏–Ω (perform_spin), –¥–æ 4 –ø–æ–ø—ã—Ç–æ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫:
   - **TEST_SPIN_URL_CLICK_REQUIRED**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å—Å—ã–ª–∫–∏ (WebApp/channel), –∫–ª–∏–∫–∞–µ—Ç, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ API, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω
   - **TELEGRAM_SUBSCRIPTION_REQUIRED**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç username –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ, –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª –∏–ª–∏ invite link), –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω
   - **BALANCE_REPLENISHMENT_REQUIRED**: –ü—Ä–æ–±—É–µ—Ç tunnel/portal clicks, task clicks, WebApp —Å—Å—ã–ª–∫–∏ –∏–∑ reward, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω
7. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—É (process_reward)
8. –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∑–≤–µ–∑–¥—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (activate_all_stars) - –ø—Ä–æ–≤–µ—Ä–∫–∞ –í–°–ï–ì–î–ê –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
9. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞–µ—Ç –¥–µ—à–µ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –µ—Å–ª–∏ GIFT_EXCHANGE_AFTER_SPIN=True

**–ù–û–í–´–ô –§–õ–û–£: –ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ—Ä–∏ —Å–ø–∏–Ω–æ–≤**:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –í–°–ï–• –∞–∫–∫–∞—É–Ω—Ç–æ–≤
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã —Å –±–∞–ª–∞–Ω—Å–æ–º >= 200‚≠ê
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –Ω–∞ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞—Ö
4. –í—ã–≤–æ–¥–∏—Ç –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "üé∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–µ–ª–∞–Ω–æ –ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤: X –∏–∑ Y –∞–∫–∫–∞—É–Ω—Ç–æ–≤"
5. –≠—Ç–æ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã:
   - –ì–¥–µ —Ñ—Ä–∏ —Å–ø–∏–Ω –Ω–µ —É–¥–∞–ª—Å—è (balance replenishment required –∏ —Ç.–¥.) –Ω–æ –±–∞–ª–∞–Ω—Å >= 200‚≠ê
   - –ì–¥–µ —É–∂–µ –±—ã–ª –±–∞–ª–∞–Ω—Å >= 200‚≠ê –¥–æ —Ñ—Ä–∏ —Å–ø–∏–Ω–∞
   - –ì–¥–µ –±–∞–ª–∞–Ω—Å –¥–æ—Å—Ç–∏–≥ 200‚≠ê –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ñ—Ä–∏ —Å–ø–∏–Ω–æ–≤

**–ü–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω (perform_single_paid_spin)**:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å >= 200 –∑–≤–µ–∑–¥
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—ã—á–Ω—ã–π `perform_spin()` - API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω –∫–æ–≥–¥–∞ –±–∞–ª–∞–Ω—Å >= 200‚≠ê
3. –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∑–≤–µ–∑–¥—ã –∏ –ø—Ä–æ–¥–∞–µ—Ç –¥–µ—à–µ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏

**–í–ê–ñ–ù–û**: –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `perform_paid_spin()` —Å —Ç–∏–ø–∞–º–∏ "PAID"/"X200"/"PREMIUM" - API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–∏ —Ç–∏–ø—ã. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–±—ã—á–Ω—ã–π `perform_spin()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å–ø–∏–Ω–∞ –ø–æ –±–∞–ª–∞–Ω—Å—É.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (check_single_account_balance)**:
1. –ü–æ–ª—É—á–∞–µ—Ç user info (get_user_info) —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (get_roulette_inventory) —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–¥–∞—Ä–∫–∏ (status IN_PROGRESS/active, –Ω–µ Stars/Viruses)
4. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–≤–µ–∑–¥—ã –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (status NONE)
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞–µ—Ç –¥–µ—à–µ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –µ—Å–ª–∏ GIFT_EXCHANGE_ON_BALANCE_CHECK=True

**–î–≤—É—Ö—Ñ–∞–∑–Ω—ã–π workflow –¥–ª—è —Ñ—Ä–∏ —Å–ø–∏–Ω–æ–≤ (telegram_bot.py, action="spin")**:
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–§—Ä–∏ —Å–ø–∏–Ω—ã" –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–π workflow:

**–§–∞–∑–∞ 1 - –§—Ä–∏ —Å–ø–∏–Ω—ã**:
1. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—Ä–∏ —Å–ø–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (perform_spins_batch)
2. –ö–∞–∂–¥—ã–π —Å–ø–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏—é –∑–≤–µ–∑–¥ (–¥–∞–∂–µ –µ—Å–ª–∏ —Å–ø–∏–Ω –Ω–µ —É–¥–∞–ª—Å—è)
   - –î–µ–ª–∞–µ—Ç –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π `perform_spin()` –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å >= 200‚≠ê (—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º "–ê–í–¢–û –ü–õ–ê–¢–ù–´–ô –°–ü–ò–ù")
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫, –±–∞–ª–∞–Ω—Å–∞, 24-—á–∞—Å–æ–≤—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**–§–∞–∑–∞ 2 - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã** (–ù–û–í–û–ï):
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –í–°–ï–• —Ñ—Ä–∏ —Å–ø–∏–Ω–æ–≤:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –í–°–ï–• –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (get_all_balances)
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã —Å –±–∞–ª–∞–Ω—Å–æ–º >= 200‚≠ê
3. –î–µ–ª–∞–µ—Ç –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π `perform_spin()` –Ω–∞ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞—Ö (perform_paid_spins_batch)
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –û–î–ù–û —Å—É–º–º–∞—Ä–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "üé∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–µ–ª–∞–Ω–æ –ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤: N –∏–∑ M –∞–∫–∫–∞—É–Ω—Ç–æ–≤"

**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ñ–∞–∑–∞ 2**:
- –ü–æ–∫—Ä—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏ –∫–æ–≥–¥–∞ —Ñ—Ä–∏ —Å–ø–∏–Ω –Ω–µ —É–¥–∞–ª—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä "balance replenishment required"), –Ω–æ –±–∞–ª–∞–Ω—Å >= 200‚≠ê
- –ü–æ–∫—Ä—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏ –∫–æ–≥–¥–∞ –±–∞–ª–∞–Ω—Å —É–∂–µ –±—ã–ª >= 200‚≠ê –¥–æ —Ñ—Ä–∏ —Å–ø–∏–Ω–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ –Ω–∏ –æ–¥–∏–Ω –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω –Ω–µ –ø—Ä–æ–ø—É—â–µ–Ω

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã (perform_hourly_auto_spins)**:
–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å –∏–∑ auto_update_and_spins_monitor:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã —Å –±–∞–ª–∞–Ω—Å–æ–º >= AUTO_SPIN_THRESHOLD (200 –∑–≤–µ–∑–¥)
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –±–∞—Ç—á–∞–º–∏ (perform_paid_spins_batch)
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

## GraphQL API Structure

API endpoint: `https://virusgift.pro/api/graphql/query`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`

**Batch mode**: API –æ–∂–∏–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `x-batch: true`

**–ö–ª—é—á–µ–≤—ã–µ –º—É—Ç–∞—Ü–∏–∏**:
- `authTelegramInitData(initData, refCode)` - –ø–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω
- `startRouletteSpin(input: {type})` - —Å–¥–µ–ª–∞—Ç—å —Å–ø–∏–Ω (type: "X1" –¥–ª—è —Ñ—Ä–∏, "PAID" –¥–ª—è –ø–ª–∞—Ç–Ω–æ–≥–æ)
- `claimRoulettePrize(input: {userPrizeId})` - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- `exchangeRoulettePrizeToStarsBalance(input: {userPrizeId})` - –ø—Ä–æ–¥–∞—Ç—å –ø—Ä–∏–∑ –∑–∞ –∑–≤–µ–∑–¥—ã
- `markTestSpinUrlClick(initData)` - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫ –ø–æ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Å—ã–ª–∫–µ
- `markTestSpinTonnelClick` - –ø—Ä–æ–π—Ç–∏ tunnel onboarding
- `markTestSpinPortalClick` - –ø—Ä–æ–π—Ç–∏ portal onboarding
- `markTestSpinTaskClick(taskId)` - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫ –ø–æ –∑–∞–¥–∞—á–µ

**–ö–ª—é—á–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã**:
- `me` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–±–∞–ª–∞–Ω—Å, –∑–≤–µ–∑–¥—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- `getRouletteInventory(cursor, limit)` - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)

## Important Implementation Details

### Session Management
- Telethon .session —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ `sessions/` (case-insensitive: .session, .Session, .SESSION)
- SessionManager –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞—Ñ–æ—Ä (limit: 10) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è SQLite database lock conflicts
- –ü—Ä–∏ "database is locked" –æ—à–∏–±–∫–µ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–π –∫—ç—à–∏—Ä—É–µ—Ç—Å—è (TTL: SESSION_VALIDATION_CACHE_TTL = 300s)

### Channel Subscription Management
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫** (cleanup_channel_subscriptions):
  - Telegram –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç –Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (~500-1000 –∫–∞–Ω–∞–ª–æ–≤)
  - –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Å–ø–∏–Ω–æ–º
  - –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–æ–∫ > 100 ‚Üí –æ—Ç–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –æ—Ç –í–°–ï–• –∫–∞–Ω–∞–ª–æ–≤
  - –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ broadcast –∫–∞–Ω–∞–ª—ã (–Ω–µ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—ã, –Ω–µ –±–æ—Ç—ã)
  - **–ë–´–°–¢–†–ê–Ø –æ—Ç–ø–∏—Å–∫–∞**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞—á–∫–∞–º–∏ –ø–æ 50 –∫–∞–Ω–∞–ª–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (asyncio.gather)
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 0.1 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –ø–∞—á–∫–∞–º–∏ (–≤–º–µ—Å—Ç–æ 1 —Å–µ–∫—É–Ω–¥—ã –∫–∞–∂–¥—ã–µ 10)
  - –õ–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—á–∫–∏
- **–¶–µ–ª—å**: –û—Å–≤–æ–±–æ–∂–¥–∞—Ç—å –º–µ—Å—Ç–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫, —Ç—Ä–µ–±—É–µ–º—ã—Ö API
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è**: –õ—É—á—à–µ –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –≤—Å–µ—Ö —Å—Ç–∞—Ä—ã—Ö, —á–µ–º –Ω–µ —Å—É–º–µ—Ç—å –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–æ–≤—ã–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 250 –∫–∞–Ω–∞–ª–æ–≤ –æ—á–∏—â–∞–µ—Ç—Å—è –∑–∞ ~1-2 —Å–µ–∫—É–Ω–¥—ã (–≤–º–µ—Å—Ç–æ ~25 —Å–µ–∫—É–Ω–¥)

### Performance Optimization
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å (180s), –±–∞–ª–∞–Ω—Å—ã (120s), user data (600s)
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –í—Å–µ batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –±–µ–∑ —Å–µ–º–∞—Ñ–æ—Ä–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
- **Rate limiting**: MIN_REQUEST_INTERVAL = 0.5s –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- **Connection pooling**: HTTP_CONNECTION_POOL_SIZE = 100, keepalive_timeout = 60s

### Error Handling Patterns

**–°–ø–∏–Ω –æ—à–∏–±–∫–∏ (perform_spin)** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –¥–æ 4 –ø–æ–ø—ã—Ç–æ–∫:

1. **TEST_SPIN_URL_CLICK_REQUIRED** - –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–ª–∏–∫ –ø–æ —Å—Å—ã–ª–∫–µ:
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Å—ã–ª–∫—É –∏–∑ reward['link']
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø: WebApp (/dapp, startapp=) –∏–ª–∏ –∫–∞–Ω–∞–ª
   - WebApp: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ requestWebView, –ø–æ–ª—É—á–∞–µ—Ç init_data, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ mark_test_spin_task_click
   - –ö–∞–Ω–∞–ª: –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ handle_subscription_requirement, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–ª–∏–∫
   - –ñ–¥–µ—Ç 2-5 —Å–µ–∫—É–Ω–¥, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω

2. **TELEGRAM_SUBSCRIPTION_REQUIRED** - –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª:
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç @username –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ —á–µ—Ä–µ–∑ regex
   - –ë–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ reward (username, url) –µ—Å–ª–∏ –µ—Å—Ç—å
   - –ü—Ä–æ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –ø–æ username (–±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤)
   - Fallback: –ø–æ–¥–ø–∏—Å–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ invite links)
   - –ñ–¥–µ—Ç 5 —Å–µ–∫—É–Ω–¥, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω
   - **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏ —Å traceback

3. **BALANCE_REPLENISHMENT_REQUIRED** - –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ (–ù–û–í–û–ï):
   - –ú–µ—Ç–æ–¥ 1: –ü—Ä–æ–±—É–µ—Ç onboarding –¥–µ–π—Å—Ç–≤–∏—è (tunnel click, portal click)
   - –ú–µ—Ç–æ–¥ 2: –ò—â–µ—Ç task_id –≤ reward, –≤—ã–∑—ã–≤–∞–µ—Ç mark_test_spin_task_click
   - –ú–µ—Ç–æ–¥ 3: –ò—â–µ—Ç link –≤ reward, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ WebApp
   - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ - –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ø–∏–Ω
   - –ï—Å–ª–∏ –Ω–µ—É–¥–∞—á–Ω–æ - –ª–æ–≥–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏

4. **TEST_SPIN_TONNEL_CLICK_REQUIRED** - –¢—Ä–µ–±—É–µ—Ç—Å—è tunnel click:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ claim_roulette_prize

5. **Portal click required** - –¢—Ä–µ–±—É–µ—Ç—Å—è portal click:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ claim_roulette_prize

**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Å—ã–ª–æ–∫ (click_test_spin_url)**:
- WebApp —Å—Å—ã–ª–∫–∏ (/dapp, startapp=) - –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ requestWebView, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç init_data
- –ö–∞–Ω–∞–ª —Å—Å—ã–ª–∫–∏ (t.me/username) - –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JoinChannelRequest
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (t.me/+hash, t.me/joinchat/hash) - –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ ImportChatInviteRequest

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ (handle_subscription_requirement)** - –ü–†–û–ë–£–ï–¢ –í–°–ï –ú–ï–¢–û–î–´:
- **–í–ê–ñ–ù–û**: –ü—Ä–æ–±—É–µ—Ç –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –º–µ—Ç–æ–¥ —Å—Ä–∞–±–æ—Ç–∞–ª

**–ú–ï–¢–û–î 1 - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ username**:
- –ü–æ–ª—É—á–∞–µ—Ç entity –ø–æ @username
- –ï—Å–ª–∏ Channel ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JoinChannelRequest
- –ï—Å–ª–∏ User/Bot ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`
- –ù–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö, –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã

**–ú–ï–¢–û–î 2 - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ URL** (3 –≤–∞—Ä–∏–∞–Ω—Ç–∞):
- **–í–∞—Ä–∏–∞–Ω—Ç 2.1**: –ü—Ä–∏–≤–∞—Ç–Ω–∞—è invite —Å—Å—ã–ª–∫–∞ (t.me/+hash, t.me/joinchat/hash)
  - –ò–∑–≤–ª–µ–∫–∞–µ—Ç hash, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ImportChatInviteRequest
- **–í–∞—Ä–∏–∞–Ω—Ç 2.2**: –°—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º start (t.me/bot?start=param)
  - –ò–∑–≤–ª–µ–∫–∞–µ—Ç bot username –∏ start –ø–∞—Ä–∞–º–µ—Ç—Ä
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start –ø–∞—Ä–∞–º–µ—Ç—Ä` –±–æ—Ç—É
- **–í–∞—Ä–∏–∞–Ω—Ç 2.3**: –ü—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª (t.me/channel_name)
  - –ü–æ–ª—É—á–∞–µ—Ç entity –ø–æ username –∏–∑ URL
  - –ï—Å–ª–∏ Channel ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
  - –ï—Å–ª–∏ User/Bot ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å —ç–º–æ–¥–∑–∏ (üì° –ú–µ—Ç–æ–¥ X, ‚úÖ —É—Å–ø–µ—Ö, ‚ö†Ô∏è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è**: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ API –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚Üí –±–æ—Ç –ø—Ä–æ–±—É–µ—Ç –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### Inventory Logic

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è –∑–≤–µ–∑–¥ (activate_all_stars)** - –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê –° –ß–ê–°–¢–ò–ß–ù–û–ô –ê–ö–¢–ò–í–ê–¶–ò–ï–ô:
- **–ö–†–ò–¢–ò–ß–ù–û**: –ü—Ä–æ–≤–µ—Ä—è–µ–º –°–£–ú–ú–£ (–±–∞–ª–∞–Ω—Å + –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å)
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è**: –ï—Å–ª–∏ –°–£–ú–ú–ê >= 200‚≠ê ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ß–ê–°–¢–ò–ß–ù–û –¥–æ –±–∞–ª–∞–Ω—Å–∞ 200-220‚≠ê ‚Üí –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ 1**: –£–∂–µ –µ—Å—Ç—å >= 200‚≠ê –Ω–∞ –±–∞–ª–∞–Ω—Å–µ?
  - –ï—Å–ª–∏ –î–ê - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞ (—É–∂–µ –≥–æ—Ç–æ–≤—ã –∫ –ø–ª–∞—Ç–Ω–æ–º—É —Å–ø–∏–Ω—É)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ 2**: –°–£–ú–ú–ê (–±–∞–ª–∞–Ω—Å + –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å) >= 200‚≠ê?
  - –ï—Å–ª–∏ –ù–ï–¢ - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –æ—Ç–ª–æ–∂–µ–Ω–∞, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∫–æ–ø–∏—Ç—å
  - –ï—Å–ª–∏ –î–ê - –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º **–ß–ê–°–¢–ò–ß–ù–û** –¥–æ –±–∞–ª–∞–Ω—Å–∞ 200-220‚≠ê
- **–ß–∞—Å—Ç–∏—á–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è**: –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∑–≤–µ–∑–¥—ã –ø–æ–∫–∞ –±–∞–ª–∞–Ω—Å –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç 220‚≠ê (–∏–ª–∏ –º–µ–Ω—å—à–µ –µ—Å–ª–∏ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ –º–µ–Ω—å—à–µ)
- **–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç—Å—è –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω (—Å—Ç–æ–∏—Ç 200‚≠ê)
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Å–ø–∏–Ω–µ –≤ Telegram
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤–µ—Å—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (pagination via cursor/nextCursor)
- –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∑–≤–µ–∑–¥—ã —Å–æ status="NONE" –∏ isClaimable=True
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- **–í–ê–ñ–ù–û**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–í–°–ï–ì–î–ê**, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ—Ä–∏ —Å–ø–∏–Ω –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π:
  - –ü—Ä–∏ –æ—à–∏–±–∫–µ "–Ω–µ –ø—Ä–æ—à–ª–æ 24 —á–∞—Å–∞"
  - –ü—Ä–∏ –æ—à–∏–±–∫–µ "–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ª–æ–≤–∏—è"
  - –ü—Ä–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –æ—à–∏–±–∫–µ —Ñ—Ä–∏ —Å–ø–∏–Ω–∞
  - –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö –ø–æ–¥–ø–∏—Å–æ–∫/–∫–ª–∏–∫–æ–≤
  - –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ –∑–≤–µ–∑–¥—ã –±—É–¥—É—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã —Å–¥–µ–ª–∞–Ω—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—à–∏–±–æ–∫

**–ü—Ä–∏–º–µ—Ä —Ü–∏–∫–ª–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**:
1. –ë–∞–ª–∞–Ω—Å: 150‚≠ê, –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: 30‚≠ê ‚Üí –°–£–ú–ú–ê: 180‚≠ê ‚Üí ‚ùå –ù–ï –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º (< 200‚≠ê)
2. –ë–∞–ª–∞–Ω—Å: 150‚≠ê, –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: 80‚≠ê ‚Üí –°–£–ú–ú–ê: 230‚≠ê ‚Üí ‚úÖ –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º 70‚≠ê –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
3. –ë–∞–ª–∞–Ω—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è: 220‚≠ê, –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: 10‚≠ê (–æ—Å—Ç–∞—Ç–æ–∫)
4. üé∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞—Ç–Ω—ã–π —Å–ø–∏–Ω ‚Üí –ë–∞–ª–∞–Ω—Å: 20‚≠ê
5. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∫–æ–ø–∏—Ç—å...

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏**:
- –ù–µ —Ç—Ä–∞—Ç–∏–º –ª–∏—à–Ω–∏–µ –∑–≤–µ–∑–¥—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- –ë—ã—Å—Ç—Ä–µ–µ –¥–µ–ª–∞–µ–º –ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã (–Ω–µ –∂–¥—ë–º 200‚≠ê –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ)
- –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**–ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ (auto_exchange_cheap_gifts)**:
- –ü—Ä–æ–¥–∞–µ—Ç –¥–µ—à–µ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ü—Ä–æ–¥–∞–µ—Ç –ø–æ–¥–∞—Ä–∫–∏ —Å–æ status IN_PROGRESS/active (–Ω–µ NONE!)
- –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ —Ü–µ–Ω–µ <= AUTO_GIFT_EXCHANGE_THRESHOLD (200 –∑–≤–µ–∑–¥)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç isClaimable –∏–ª–∏ isExchangeable
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç Stars –∏ Viruses (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏)
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä—è–º–æ–π –æ–±–º–µ–Ω (exchangeRoulettePrizeToStarsBalance), fallback - claim
- unlock_at - —ç—Ç–æ –≤—Ä–µ–º—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ Telegram, –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –∑–∞ –∑–≤–µ–∑–¥—ã

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**:
- –§—Ä–∏ —Å–ø–∏–Ω –ø–æ–¥–∞—Ä–∫–∏: "üéÅ –§–†–ò –°–ü–ò–ù | —Å–µ—Å—Å–∏—è | –Ω–∞–∑–≤–∞–Ω–∏–µ | —Ü–µ–Ω–Ω–æ—Å—Ç—å‚≠ê"
- –î–æ—Ä–æ–≥–∏–µ –ø–æ–¥–∞—Ä–∫–∏ (> HIGH_VALUE_THRESHOLD): "üíé –§–†–ò –°–ü–ò–ù | —Å–µ—Å—Å–∏—è | –Ω–∞–∑–≤–∞–Ω–∏–µ | —Ü–µ–Ω–Ω–æ—Å—Ç—å‚≠ê"
- **–ü–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã (—Ñ–∞–∑–∞ 2)**: –û–î–ù–û —Å—É–º–º–∞—Ä–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤:
  - "üé∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–µ–ª–∞–Ω–æ –ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤: N –∏–∑ M –∞–∫–∫–∞—É–Ω—Ç–æ–≤"
  - –ï—Å–ª–∏ –µ—Å—Ç—å —Ü–µ–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏: –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ "üíé –¶–µ–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏: —Å–µ—Å—Å–∏—è: –Ω–∞–∑–≤–∞–Ω–∏–µ"
- **–í–ê–ñ–ù–û**: –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–∞—Ö –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å)

## Configuration

**–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.py**:

```python
# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
MAX_CONCURRENT_SESSIONS = 100  # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–µ—Å—Å–∏–∏
DELAY_BETWEEN_ACCOUNTS = 0.3   # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
HTTP_CONNECTION_POOL_SIZE = 100

# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
AUTO_SPIN_ENABLED = True
AUTO_SPIN_THRESHOLD = 200      # –ú–∏–Ω–∏–º—É–º –∑–≤–µ–∑–¥ –¥–ª—è –∞–≤—Ç–æ—Å–ø–∏–Ω–∞
AUTO_SPIN_CHECK_INTERVAL = 300 # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—É—Å—Ç–∞—Ä–µ–ª–æ, —Ç–µ–ø–µ—Ä—å 1 —á–∞—Å)

AUTO_GIFT_EXCHANGE_ENABLED = True
AUTO_GIFT_EXCHANGE_THRESHOLD = 200  # –ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ ‚â§200 –∑–≤–µ–∑–¥
GIFT_EXCHANGE_AFTER_SPIN = True
GIFT_EXCHANGE_ON_BALANCE_CHECK = True

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
INVENTORY_CACHE_TTL = 180      # 3 –º–∏–Ω—É—Ç—ã
BALANCE_CACHE_TTL = 120        # 2 –º–∏–Ω—É—Ç—ã
USER_DATA_CACHE_TTL = 600      # 10 –º–∏–Ω—É—Ç
SESSION_VALIDATION_CACHE_TTL = 300  # 5 –º–∏–Ω—É—Ç
```

## Common Tasks

### Testing a Single Account
```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test_*.py —Ñ–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python test_spin.py           # –¢–µ—Å—Ç –æ–¥–Ω–æ–≥–æ —Å–ø–∏–Ω–∞
python test_full_flow.py      # –ü–æ–ª–Ω—ã–π flow
python test_activation_logic.py  # –¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
```

### Debugging GraphQL Requests
–í—Å–µ GraphQL –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `logs/graphql_*.log` —Å –ø–æ–ª–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, payload –∏ –æ—Ç–≤–µ—Ç–∞–º–∏. JWT —Ç–æ–∫–µ–Ω—ã –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è (–ø–µ—Ä–≤—ã–µ 10 + –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–∏–º–≤–æ–ª–æ–≤).

### Adding New GraphQL Operations
1. –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–æ–¥ –≤ VirusAPI –∫–ª–∞—Å—Å
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `_make_graphql_request(query, variables, operation_name)`
3. API –æ–∂–∏–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤ –¥–ª—è batch —Ä–µ–∂–∏–º–∞: `payload = [single_query]`
4. –ü–∞—Ä—Å–∏—Ç–µ –æ—Ç–≤–µ—Ç: `if isinstance(json_response, list): return json_response[0]`

### Working with Large Account Counts
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ (perform_spins_batch, validate_all_accounts_batch) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç progress_callback
- Progress callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å (completed, total) –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
- Telegram UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–µ —á–∞—â–µ —á–µ–º —Ä–∞–∑ –≤ 1.5 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ REDUCED_LOGGING_MODE = True –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤

## Testing Infrastructure

**test_activation_logic.py** - —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É –∫–ª–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–∞–º (WebApp vs channels)
**test_channel_subscription.py** - —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª—ã
**test_full_flow.py** - –ø–æ–ª–Ω—ã–π flow: auth, user info, spin, inventory
**test_spin.py** - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å–ø–∏–Ω–∞
**test_webapp.py** - —Ç–µ—Å—Ç WebApp –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## Logging

–õ–æ–≥–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —Ç–∏–ø–∞–º (—Å–º. GRAPHQL_LOGGING_GUIDE.md):
- `logs/general_*.log` - –æ–±—â–∏–µ —Å–æ–±—ã—Ç–∏—è
- `logs/graphql_*.log` - GraphQL –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã (–¥–µ—Ç–∞–ª—å–Ω–æ)
- `logs/debug_*.log` - debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (virus_api, spin_worker)
- `virus_bot.log` - —Ä–æ—Ç–∏—Ä—É—é—â–∏–π –æ–±—â–∏–π –ª–æ–≥ (50MB)
- `logs/graphql_requests.log` - —Ä–æ—Ç–∏—Ä—É—é—â–∏–π GraphQL –ª–æ–≥ (100MB)

## Important Notes

- **–ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å .env –∏ .session —Ñ–∞–π–ª—ã** (–æ–Ω–∏ –≤ .gitignore)
- **JWT —Ç–æ–∫–µ–Ω—ã** –≤—Å–µ–≥–¥–∞ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **SQLite locks**: SessionManager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç database lock conflicts
- **Case-insensitive sessions**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è .session, .Session, .SESSION
- **–ï–∂–µ—á–∞—Å–Ω—ã–µ –∞–≤—Ç–æ—Å–ø–∏–Ω—ã**: –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∏–∑ auto_update_and_spins_monitor –∫–∞–∂–¥—ã–π —á–∞—Å (–Ω–µ AUTO_SPIN_CHECK_INTERVAL)
- **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –º–∏–Ω–∏–º—É–º**: –í—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 100 –∑–≤–µ–∑–¥ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–¥–ª—è —Ü–µ–Ω–Ω—ã—Ö –ø–æ–¥–∞—Ä–∫–æ–≤)
